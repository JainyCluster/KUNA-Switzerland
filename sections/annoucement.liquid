<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>

{% if section.settings.show_announcement == true %}
    {% if section.settings.homepage_only == false or request.page_type == 'index' %}
        {% style %}
            .announcement-bar {
                background-color: {{ settings.color_annoucement_bg | default: '#222' }};
                {% if section.settings.show_divider %}
                border-bottom: 1px solid var(--color-border);
                {% endif %}
            }
            .announcement-bar__content, .sf-topbar__close {
                color: {{ settings.color_annoucement_text | default: '#fff' }}
            }
            .announcement-bar a:hover {
                opacity: .6;
            }
        {% endstyle %}
        <section
          id="BarraAnuncio"
            data-section-id="{{ section.id }}"
            data-section-type="announcement"
            class="announcement-bar relative"
        >

      <!-- Slider main container -->
      <div class="swiper" style="    width: calc(100% - 80px);">

        <!-- Additional required wrapper -->
          <div class="swiper-wrapper">

{% for block in section.blocks %}  

 <div class="swiper-slide">


      {%- unless block.settings.message_link == blank -%}
                <a href="{{ block.settings.message_link }}" class="announcement-bar__link">
            {%- endunless -%}
                <div class="announcement-bar__content md:text-center py-2.5 text-base">{{ block.settings.txt_mensaje }}</div>
            {%- unless block.settings.message_link == blank -%}
                </a>
       {%- endunless -%}
   
 </div>

{% endfor %} 

  </div> 

</div>
            {% if section.settings.show_close %}
                <div class="sf-topbar__close p-3 absolute top-0 right-0 cursor-pointer h-full flex items-center">
                    {% render 'icon', name: 'x', size: 'medium' %}
                </div>
                <script>
                    document.querySelector('.sf-topbar__close').addEventListener('click', function () {
                        document.querySelector('.announcement-bar').remove()
                        document.documentElement.style.setProperty('--sf-announcement-height', '0px')
                    })
                </script>
            {% endif %}
        </section>
    {% endif %}
{% endif %}

<style>
#BarraAnuncio .swiper-slide {
  display: flex;
  align-items: center;
  justify-content: center;
}
</style>

<script>
const BarraAnuncio = new Swiper("#BarraAnuncio .swiper", {
  loop: true,
  preloadImages: false,
  // Enable lazy loading
  lazy: true,
  autoplay: {
    delay: 3000,
    disableOnInteraction: false,
  },
});
</script> 

{% schema %}
{
  "name": "CLUSTER | Announcement",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_announcement",
      "label": "Show announcement",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "homepage_only",
      "label": "Home page only",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_close",
      "label": "Show close button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_divider",
      "label": "Show divider",
      "default": false
    }
  ],
  "blocks" : [
      {
        "type": "slide",
        "name": "Slide",
 "settings": [
    {
      "type": "url",
      "id": "message_link",
      "label": "Link"
    },            
    {
      "type": "textarea",
      "id": "txt_mensaje",
      "label": "Mensaje",
      "default": "Texto predeterminado"
    }
        ]
      }
    ]  
}
{% endschema %}
